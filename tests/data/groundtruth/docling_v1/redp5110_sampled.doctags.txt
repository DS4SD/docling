<document>
<figure>
<location><page_1><loc_84><loc_93><loc_96><loc_97></location>
</figure>
<subtitle-level-1><location><page_1><loc_6><loc_84><loc_96><loc_89></location>Row and Column Access Control</subtitle-level-1>
<figure>
<location><page_1><loc_5><loc_11><loc_96><loc_63></location>
</figure>
<figure>
<location><page_1><loc_52><loc_2><loc_95><loc_10></location>
</figure>
<subtitle-level-1><location><page_2><loc_11><loc_88><loc_28><loc_91></location>Contents</subtitle-level-1>
<paragraph><location><page_3><loc_15><loc_80><loc_23><loc_81></location>Solution Brief</paragraph>
<figure>
<location><page_3><loc_23><loc_64><loc_29><loc_66></location>
</figure>
<subtitle-level-1><location><page_3><loc_24><loc_57><loc_31><loc_59></location>Highlights</subtitle-level-1>
<paragraph><location><page_3><loc_24><loc_56><loc_24><loc_56></location>- /g115/g3</paragraph>
<paragraph><location><page_3><loc_24><loc_53><loc_24><loc_54></location>- /g115/g3</paragraph>
<paragraph><location><page_3><loc_24><loc_49><loc_24><loc_50></location>- /g115/g3</paragraph>
<paragraph><location><page_3><loc_24><loc_46><loc_24><loc_47></location>- /g115/g3</paragraph>
<figure>
<location><page_3><loc_10><loc_13><loc_42><loc_24></location>
</figure>
<paragraph><location><page_3><loc_75><loc_82><loc_83><loc_83></location>Power Services</paragraph>
<subtitle-level-1><location><page_3><loc_46><loc_68><loc_60><loc_71></location>DB2 for i</subtitle-level-1>
<paragraph><location><page_3><loc_46><loc_64><loc_79><loc_65></location>Expert help to achieve your business requirements</paragraph>
<subtitle-level-1><location><page_3><loc_46><loc_59><loc_72><loc_60></location>We build confident, satisfied clients</subtitle-level-1>
<paragraph><location><page_3><loc_46><loc_58><loc_80><loc_59></location>No one else has the vast consulting experiences, skills sharing and</paragraph>
<paragraph><location><page_3><loc_46><loc_54><loc_60><loc_55></location>Because no one else is IBM.</paragraph>
<paragraph><location><page_3><loc_46><loc_51><loc_82><loc_52></location>With combined experiences and direct access to development groups,</paragraph>
<subtitle-level-1><location><page_3><loc_46><loc_44><loc_71><loc_45></location>Who we are, some of what we do</subtitle-level-1>
<paragraph><location><page_3><loc_46><loc_42><loc_71><loc_43></location>Global CoE engagements cover topics including:</paragraph>
<paragraph><location><page_3><loc_46><loc_40><loc_46><loc_41></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_39><loc_46><loc_39></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_37><loc_46><loc_38></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_36><loc_46><loc_37></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_35><loc_46><loc_35></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_33><loc_46><loc_34></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_32><loc_46><loc_33></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_31><loc_46><loc_32></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<paragraph><location><page_3><loc_46><loc_30><loc_46><loc_30></location>- rglyph<c=1,font=/NKDKKL+JansonTextLTStd-Roman></paragraph>
<subtitle-level-1><location><page_4><loc_11><loc_88><loc_25><loc_91></location>Preface</subtitle-level-1>
<paragraph><location><page_4><loc_22><loc_82><loc_89><loc_83></location>This IBMfi Redpaperâ„¢ publication provides information about the IBM i 7.2 feature of IBM</paragraph>
<paragraph><location><page_4><loc_22><loc_72><loc_86><loc_73></location>This paper is intended for database engineers, data-centric application developers, and</paragraph>
<paragraph><location><page_4><loc_22><loc_58><loc_89><loc_60></location>This paper was produced by the IBM DB2 for i Center of Excellence team in partnership with</paragraph>
<figure>
<location><page_4><loc_23><loc_36><loc_41><loc_53></location>
</figure>
<paragraph><location><page_4><loc_43><loc_51><loc_55><loc_53></location>Jim Bainbridge</paragraph>
<figure>
<location><page_4><loc_24><loc_20><loc_41><loc_33></location>
</figure>
<paragraph><location><page_4><loc_43><loc_32><loc_57><loc_33></location>Hernando Bedoya</paragraph>
<subtitle-level-1><location><page_4><loc_11><loc_62><loc_20><loc_64></location>Authors</subtitle-level-1>
<figure>
<location><page_5><loc_5><loc_70><loc_39><loc_91></location>
</figure>
<paragraph><location><page_5><loc_82><loc_84><loc_85><loc_88></location>1</paragraph>
<subtitle-level-1><location><page_5><loc_22><loc_65><loc_90><loc_68></location>Securing and protecting IBM DB2</subtitle-level-1>
<paragraph><location><page_5><loc_22><loc_55><loc_89><loc_56></location>Recent news headlines are filled with reports of data breaches and cyber-attacks impacting</paragraph>
<paragraph><location><page_5><loc_22><loc_43><loc_86><loc_44></location>Businesses must make a serious effort to secure their data and recognize that securing</paragraph>
<paragraph><location><page_5><loc_22><loc_36><loc_89><loc_37></location>This chapter describes how you can secure and protect data in DB2 for i. The following topics</paragraph>
<paragraph><location><page_5><loc_22><loc_32><loc_23><loc_33></location>- /SM590000</paragraph>
<paragraph><location><page_5><loc_22><loc_30><loc_23><loc_32></location>- /SM590000</paragraph>
<paragraph><location><page_5><loc_22><loc_29><loc_23><loc_30></location>- /SM590000</paragraph>
<subtitle-level-1><location><page_6><loc_11><loc_89><loc_44><loc_91></location>1.1  Security fundamentals</subtitle-level-1>
<paragraph><location><page_6><loc_22><loc_85><loc_89><loc_87></location>Before reviewing database security techniques, there are two fundamental steps in securing</paragraph>
<paragraph><location><page_6><loc_22><loc_82><loc_23><loc_83></location>- /SM590000</paragraph>
<paragraph><location><page_6><loc_25><loc_75><loc_89><loc_76></location>- The monitoring and assessment of adherence to the security policy determines whether</paragraph>
<paragraph><location><page_6><loc_25><loc_64><loc_89><loc_65></location>A security policy is what defines whether the system and its settings are secure (or not).</paragraph>
<paragraph><location><page_6><loc_22><loc_62><loc_23><loc_63></location>- /SM590000</paragraph>
<paragraph><location><page_6><loc_22><loc_50><loc_87><loc_51></location>With your eyes now open to the importance of securing information assets, the rest of this</paragraph>
<subtitle-level-1><location><page_6><loc_11><loc_43><loc_53><loc_45></location>1.2  Current state of IBM i security</subtitle-level-1>
<paragraph><location><page_6><loc_22><loc_39><loc_87><loc_41></location>Because of the inherently secure nature of IBM i, many clients rely on the default system</paragraph>
<paragraph><location><page_6><loc_22><loc_32><loc_84><loc_33></location>Even more disturbing is that many IBM i clients remain in this state, despite the news</paragraph>
<paragraph><location><page_6><loc_22><loc_23><loc_89><loc_24></location>Traditionally, IBM i applications have employed menu-based security to counteract this default</paragraph>
<paragraph><location><page_7><loc_22><loc_90><loc_88><loc_91></location>Many businesses are trying to limit data access to a need-to-know basis. This security goal</paragraph>
<subtitle-level-1><location><page_7><loc_11><loc_77><loc_49><loc_78></location>1.3.1  Existing row and column control</subtitle-level-1>
<paragraph><location><page_7><loc_22><loc_74><loc_87><loc_75></location>Some IBM i clients have tried augmenting the all-or-nothing object-level security with SQL</paragraph>
<paragraph><location><page_7><loc_22><loc_65><loc_86><loc_66></location>Using SQL views to limit access to a subset of the data in a table also has its own set of</paragraph>
<paragraph><location><page_7><loc_22><loc_57><loc_88><loc_59></location>Even if you are willing to live with these performance and management issues, a user with</paragraph>
<figure>
<location><page_7><loc_22><loc_13><loc_89><loc_53></location>
<caption>Figure 1-2   Existing row and column controls</caption>
</figure>
<subtitle-level-1><location><page_8><loc_11><loc_89><loc_55><loc_91></location>2.1.6  Change Function Usage CL command</subtitle-level-1>
<paragraph><location><page_8><loc_22><loc_87><loc_89><loc_88></location>The following CL commands can be used to work with, display, or change function usage IDs:</paragraph>
<paragraph><location><page_8><loc_22><loc_84><loc_23><loc_85></location>- /SM590000</paragraph>
<paragraph><location><page_8><loc_22><loc_83><loc_23><loc_84></location>- /SM590000</paragraph>
<paragraph><location><page_8><loc_22><loc_81><loc_23><loc_82></location>- /SM590000</paragraph>
<paragraph><location><page_8><loc_22><loc_79><loc_42><loc_80></location>For example, the following</paragraph>
<paragraph><location><page_8><loc_22><loc_75><loc_72><loc_76></location>CHGFCNUSG FCNID(QIBM_DB_SECADM) USER(HBEDOYA) USAGE(*ALLOWED)</paragraph>
<subtitle-level-1><location><page_8><loc_11><loc_71><loc_89><loc_72></location>2.1.7  Verifying function usage IDs for RCAC with the FUNCTION_USAGE view</subtitle-level-1>
<paragraph><location><page_8><loc_22><loc_68><loc_85><loc_69></location>The FUNCTION_USAGE view contains function usage configuration details. Table 2-1</paragraph>
<table>
<location><page_8><loc_22><loc_44><loc_89><loc_63></location>
<caption>Table 2-1   FUNCTION_USAGE view</caption>
</table>
<caption><location><page_8><loc_22><loc_64><loc_46><loc_65></location>Table 2-1   FUNCTION_USAGE view</caption>
<paragraph><location><page_8><loc_22><loc_42><loc_89><loc_43></location>To discover who has authorization to define and manage RCAC, you can use the query that is</paragraph>
<caption><location><page_8><loc_22><loc_38><loc_76><loc_39></location>Example 2-1   Query to determine who has authority to define and manage RCAC</caption>
<paragraph><location><page_8><loc_22><loc_35><loc_41><loc_36></location>SELECT     function_id,</paragraph>
<paragraph><location><page_8><loc_22><loc_31><loc_39><loc_32></location>user_type</paragraph>
<paragraph><location><page_8><loc_22><loc_29><loc_43><loc_30></location>FROM       function_usage</paragraph>
<paragraph><location><page_8><loc_22><loc_28><loc_54><loc_29></location>WHERE      function_id='QIBM_DB_SECADM'</paragraph>
<paragraph><location><page_8><loc_22><loc_26><loc_39><loc_27></location>ORDER BY   user_name;</paragraph>
<subtitle-level-1><location><page_8><loc_11><loc_20><loc_41><loc_22></location>2.2  Separation of duties</subtitle-level-1>
<paragraph><location><page_8><loc_22><loc_16><loc_86><loc_18></location>Separation of duties helps businesses comply with industry regulations or organizational</paragraph>
<paragraph><location><page_9><loc_22><loc_90><loc_89><loc_91></location>For example, assume that a business has assigned the duty to manage security on IBM i to</paragraph>
<paragraph><location><page_9><loc_22><loc_79><loc_89><loc_81></location>In IBM i 7.2, the QIBM_DB_SECADM function usage grants authorities, revokes authorities,</paragraph>
<paragraph><location><page_9><loc_22><loc_72><loc_88><loc_73></location>QIBM_DB_SECADM function usage can be granted only by a user with *SECADM special</paragraph>
<paragraph><location><page_9><loc_22><loc_68><loc_89><loc_69></location>QIBM_DB_SECADM also is responsible for administering RCAC, which restricts which rows</paragraph>
<paragraph><location><page_9><loc_22><loc_62><loc_87><loc_63></location>A preferred practice is that the RCAC administrator has the QIBM_DB_SECADM function</paragraph>
<paragraph><location><page_9><loc_22><loc_55><loc_89><loc_56></location>Table 2-2 shows a comparison of the different function usage IDs and *JOBCTL authority to</paragraph>
<table>
<location><page_9><loc_11><loc_9><loc_89><loc_50></location>
<caption>Table 2-2    Comparison of the different function usage IDs and *JOBCTL authority</caption>
</table>
<caption><location><page_9><loc_11><loc_51><loc_64><loc_52></location>Table 2-2    Comparison of the different function usage IDs and *JOBCTL authority</caption>
<caption><location><page_10><loc_22><loc_90><loc_29><loc_91></location>The SQL</caption>
<figure>
<location><page_10><loc_22><loc_48><loc_89><loc_86></location>
<caption>Figure 3-1   CREATE PERMISSION SQL statement</caption>
</figure>
<subtitle-level-1><location><page_10><loc_22><loc_43><loc_35><loc_44></location>Column mask</subtitle-level-1>
<paragraph><location><page_10><loc_22><loc_41><loc_89><loc_43></location>A column mask is a database object that manifests a column value access control rule for a</paragraph>
<caption><location><page_11><loc_22><loc_90><loc_67><loc_91></location>Table 3-1 summarizes these special registers and their values.</caption>
<table>
<location><page_11><loc_22><loc_74><loc_89><loc_87></location>
<caption>Table 3-1   Special registers and their corresponding values</caption>
</table>
<caption><location><page_11><loc_22><loc_87><loc_61><loc_88></location>Table 3-1   Special registers and their corresponding values</caption>
<paragraph><location><page_11><loc_22><loc_72><loc_88><loc_73></location>Figure 3-5 shows the difference in the special register values when an adopted authority is</paragraph>
<paragraph><location><page_11><loc_22><loc_68><loc_23><loc_69></location>- /SM590000</paragraph>
<paragraph><location><page_11><loc_22><loc_66><loc_23><loc_67></location>- /SM590000</paragraph>
<paragraph><location><page_11><loc_22><loc_64><loc_23><loc_65></location>- /SM590000</paragraph>
<paragraph><location><page_11><loc_22><loc_60><loc_23><loc_61></location>- /SM590000</paragraph>
<paragraph><location><page_11><loc_22><loc_55><loc_23><loc_56></location>- /SM590000</paragraph>
<figure>
<location><page_11><loc_22><loc_25><loc_49><loc_51></location>
<caption>Figure 3-5   Special registers and adopted authority</caption>
</figure>
<subtitle-level-1><location><page_11><loc_11><loc_20><loc_40><loc_21></location>3.2.2  Built-in global variables</subtitle-level-1>
<paragraph><location><page_11><loc_22><loc_17><loc_85><loc_18></location>Built-in global variables are provided with the database manager and are used in SQL</paragraph>
<paragraph><location><page_11><loc_22><loc_12><loc_82><loc_13></location>IBM DB2 for i supports nine different built-in global variables that are read only and</paragraph>
<paragraph><location><page_12><loc_22><loc_90><loc_56><loc_91></location>Table 3-2 lists the nine built-in global variables.</paragraph>
<table>
<location><page_12><loc_10><loc_63><loc_90><loc_87></location>
<caption>Table 3-2   Built-in global variables</caption>
</table>
<caption><location><page_12><loc_11><loc_87><loc_33><loc_88></location>Table 3-2   Built-in global variables</caption>
<subtitle-level-1><location><page_12><loc_11><loc_57><loc_63><loc_59></location>3.3  VERIFY_GROUP_FOR_USER function</subtitle-level-1>
<paragraph><location><page_12><loc_22><loc_54><loc_89><loc_55></location>The VERIFY_GROUP_FOR_USER function was added in IBM i 7.2. Although it is primarily</paragraph>
<paragraph><location><page_12><loc_22><loc_42><loc_86><loc_43></location>If a special register value is in the list of user profiles or it is a member of a group profile</paragraph>
<paragraph><location><page_12><loc_22><loc_36><loc_75><loc_38></location>Here is an example of using the VERIFY_GROUP_FOR_USER function:</paragraph>
<paragraph><location><page_12><loc_22><loc_34><loc_24><loc_35></location>- 1.</paragraph>
<paragraph><location><page_12><loc_22><loc_32><loc_24><loc_33></location>- 2.</paragraph>
<paragraph><location><page_12><loc_22><loc_30><loc_24><loc_31></location>- 3.</paragraph>
<paragraph><location><page_12><loc_25><loc_26><loc_60><loc_27></location>VERIFY_GROUP_FOR_USER (CURRENT_USER, 'MGR')</paragraph>
<paragraph><location><page_12><loc_25><loc_23><loc_74><loc_24></location>VERIFY_GROUP_FOR_USER (CURRENT_USER, 'JANE', 'MGR', 'STEVE')</paragraph>
<paragraph><location><page_13><loc_22><loc_90><loc_27><loc_91></location>RETURN</paragraph>
<paragraph><location><page_13><loc_22><loc_88><loc_26><loc_89></location>CASE</paragraph>
<paragraph><location><page_13><loc_22><loc_87><loc_76><loc_88></location>WHEN VERIFY_GROUP_FOR_USER ( SESSION_USER , 'HR', 'EMP' ) = 1</paragraph>
<paragraph><location><page_13><loc_22><loc_64><loc_24><loc_65></location>- 2.</paragraph>
<paragraph><location><page_13><loc_25><loc_60><loc_26><loc_62></location>- -</paragraph>
<paragraph><location><page_13><loc_25><loc_58><loc_26><loc_59></location>- -</paragraph>
<paragraph><location><page_13><loc_25><loc_56><loc_26><loc_57></location>- -</paragraph>
<paragraph><location><page_13><loc_25><loc_52><loc_26><loc_54></location>- -</paragraph>
<paragraph><location><page_13><loc_25><loc_50><loc_87><loc_51></location>- To implement this column mask, run the SQL statement that is shown in Example 3-9.</paragraph>
<paragraph><location><page_13><loc_22><loc_45><loc_62><loc_46></location>CREATE MASK   HR_SCHEMA.MASK_TAX_ID_ON_EMPLOYEES</paragraph>
<caption><location><page_13><loc_22><loc_48><loc_58><loc_49></location>Example 3-9   Creating a mask on the TAX_ID column</caption>
<paragraph><location><page_14><loc_22><loc_90><loc_24><loc_91></location>- 3.</paragraph>
<figure>
<location><page_14><loc_10><loc_79><loc_89><loc_88></location>
<caption>Figure 3-10   Column masks shown in System i Navigator</caption>
</figure>
<subtitle-level-1><location><page_14><loc_11><loc_73><loc_33><loc_74></location>3.6.6  Activating RCAC</subtitle-level-1>
<paragraph><location><page_14><loc_22><loc_70><loc_88><loc_71></location>Now that you have created the row permission and the two column masks, RCAC must be</paragraph>
<paragraph><location><page_14><loc_22><loc_65><loc_24><loc_66></location>- 1.</paragraph>
<subtitle-level-1><location><page_14><loc_22><loc_62><loc_61><loc_63></location>Example 3-10   Activating RCAC on the EMPLOYEES table</subtitle-level-1>
<paragraph><location><page_14><loc_22><loc_60><loc_62><loc_61></location>- /*   Active Row Access Control (permissions)  */</paragraph>
<paragraph><location><page_14><loc_22><loc_58><loc_62><loc_59></location>- /*   Active Column Access Control (masks)     */</paragraph>
<paragraph><location><page_14><loc_22><loc_54><loc_48><loc_55></location>ACTIVATE COLUMN ACCESS CONTROL;</paragraph>
<paragraph><location><page_14><loc_22><loc_51><loc_24><loc_52></location>- 2.</paragraph>
<figure>
<location><page_14><loc_10><loc_18><loc_87><loc_46></location>
<caption>Figure 3-11   Selecting the EMPLOYEES table from System i Navigator</caption>
</figure>
<paragraph><location><page_15><loc_22><loc_90><loc_24><loc_91></location>- 2.</paragraph>
<paragraph><location><page_15><loc_22><loc_35><loc_24><loc_36></location>- 3.</paragraph>
<figure>
<location><page_15><loc_22><loc_40><loc_89><loc_85></location>
<caption>Figure 4-68   Visual Explain with RCAC enabled</caption>
</figure>
<figure>
<location><page_15><loc_11><loc_16><loc_83><loc_30></location>
<caption>Figure 4-69   Index advice with no RCAC</caption>
</figure>
<paragraph><location><page_16><loc_11><loc_90><loc_29><loc_91></location>THEN C . CUSTOMER_TAX_ID</paragraph>
<paragraph><location><page_16><loc_11><loc_29><loc_82><loc_30></location>CREATE MASK BANK_SCHEMA.MASK_SECURITY_QUESTION_ANSWER_ON_CUSTOMERS ON BANK_SCHEMA.CUSTOMERS AS C</paragraph>
<subtitle-level-1><location><page_18><loc_4><loc_87><loc_73><loc_91></location>Row and Column Access Control</subtitle-level-1>
<paragraph><location><page_18><loc_4><loc_68><loc_21><loc_69></location>Implement roles and</paragraph>
<paragraph><location><page_18><loc_25><loc_68><loc_68><loc_69></location>This IBM Redpaper publication provides information about the IBM i 7.2</paragraph>
<paragraph><location><page_18><loc_4><loc_63><loc_15><loc_64></location>Leverage row</paragraph>
<paragraph><location><page_18><loc_4><loc_56><loc_20><loc_57></location>Protect columns by</paragraph>
<paragraph><location><page_18><loc_25><loc_57><loc_68><loc_58></location>This paper is intended for database engineers, data-centric application</paragraph>
<figure>
<location><page_18><loc_79><loc_93><loc_93><loc_97></location>
</figure>
<figure>
<location><page_18><loc_78><loc_76><loc_97><loc_90></location>
</figure>
<paragraph><location><page_18><loc_76><loc_67><loc_91><loc_69></location>INTERNATIONAL</paragraph>
<paragraph><location><page_18><loc_76><loc_54><loc_93><loc_56></location>BUILDING TECHNICAL</paragraph>
<paragraph><location><page_18><loc_76><loc_48><loc_96><loc_50></location>IBM Redbooks are developed</paragraph>
<paragraph><location><page_18><loc_76><loc_26><loc_93><loc_27></location>For more information:</paragraph>
</document>